---
id: meanBy
title: meanBy
description: 'Calculates the mean (average) of values generated by an iteratee function'
---

# `meanBy`

é€šè¿‡è¿­ä»£å‡½æ•°è®¡ç®—æ•°ç»„å…ƒç´ ç”Ÿæˆçš„å€¼çš„å¹³å‡å€¼ã€‚è¿™ä¸ªå‡½æ•°å…è®¸ä½ å¯¹å¯¹è±¡æ•°ç»„è¿›è¡Œå¹³å‡å€¼è®¡ç®—ï¼Œæ˜¯ç»Ÿè®¡åˆ†æä¸­çš„å¸¸ç”¨å·¥å…·ã€‚

## è¯­æ³•

```typescript
function meanBy<T>(array: T[], iteratee: (item: T) => number): number;
```

## å‚æ•°

| å‚æ•°å     | ç±»å‹                  | å¿…å¡« | é»˜è®¤å€¼ | æè¿°                                             |
| ---------- | --------------------- | ---- | ------ | ------------------------------------------------ |
| `array`    | `T[]`                 | âœ…   | -      | è¦è¿­ä»£çš„æ•°ç»„                                     |
| `iteratee` | `(item: T) => number` | âœ…   | -      | æ¯ä¸ªå…ƒç´ è°ƒç”¨çš„è¿­ä»£å‡½æ•°ï¼Œè¿”å›ç”¨äºè®¡ç®—å¹³å‡å€¼çš„æ•°å€¼ |

## è¿”å›å€¼

- **ç±»å‹**: `number`
- **æè¿°**: è¿”å›è®¡ç®—å¾—åˆ°çš„å¹³å‡å€¼ã€‚å¦‚æœæ•°ç»„ä¸ºç©ºæˆ–æ— æ•ˆï¼Œè¿”å› `0`

## ç¤ºä¾‹

### åŸºç¡€ç”¨æ³•

```typescript
import { meanBy } from '@rabjs/kit';

// ç¤ºä¾‹1: å¯¹è±¡æ•°ç»„ - æŒ‰å±æ€§è®¡ç®—å¹³å‡å€¼
const students = [
  { name: 'Alice', score: 85 },
  { name: 'Bob', score: 90 },
  { name: 'Charlie', score: 88 },
];
const avgScore = meanBy(students, (s) => s.score);
console.log(avgScore); // 87.67 (çº¦)

// ç¤ºä¾‹2: è®¡ç®—å±æ€§å¹³å‡å€¼
const products = [
  { name: 'Product A', ratings: [4, 5, 5, 4] },
  { name: 'Product B', ratings: [3, 4, 4] },
  { name: 'Product C', ratings: [5, 5, 4, 5] },
];
const avgRatingCount = meanBy(products, (p) => p.ratings.length);
console.log(avgRatingCount); // 3.67 (çº¦)

// ç¤ºä¾‹3: ç©ºæ•°ç»„
console.log(meanBy([], (x) => x.value)); // 0
```

### é«˜çº§ç”¨æ³•

```typescript
// ç¤ºä¾‹4: åµŒå¥—å¯¹è±¡
interface Employee {
  name: string;
  performance: {
    q1: number;
    q2: number;
    q3: number;
    q4: number;
  };
}

const employees: Employee[] = [
  { name: 'Alice', performance: { q1: 85, q2: 90, q3: 88, q4: 92 } },
  { name: 'Bob', performance: { q1: 78, q2: 82, q3: 80, q4: 85 } },
  { name: 'Charlie', performance: { q1: 92, q2: 95, q3: 90, q4: 94 } },
];

// è®¡ç®—å‘˜å·¥å¹´åº¦å¹³å‡ç»©æ•ˆ
const avgPerformance = meanBy(employees, (emp) => {
  const { q1, q2, q3, q4 } = emp.performance;
  return (q1 + q2 + q3 + q4) / 4;
});
console.log(avgPerformance.toFixed(2)); // 87.08

// ç¤ºä¾‹5: æ¡ä»¶å¹³å‡å€¼
const scores = [
  { student: 'Alice', score: 85, subject: 'Math' },
  { student: 'Bob', score: 92, subject: 'Math' },
  { student: 'Charlie', score: 78, subject: 'Science' },
  { student: 'David', score: 88, subject: 'Math' },
];

// åªè®¡ç®—æ•°å­¦ç§‘ç›®çš„å¹³å‡åˆ†
const mathAvg = meanBy(
  scores.filter((s) => s.subject === 'Math'),
  (s) => s.score,
);
console.log(mathAvg); // 88.33

// ç¤ºä¾‹6: å­—ç¬¦ä¸²é•¿åº¦å¹³å‡å€¼
const words = [
  { text: 'hello', language: 'en' },
  { text: 'world', language: 'en' },
  { text: 'test', language: 'en' },
];
const avgLength = meanBy(words, (w) => w.text.length);
console.log(avgLength); // 4.67
```

### å®é™…åº”ç”¨åœºæ™¯

```typescript
// ç¤ºä¾‹7: ç”µå•†è¯„åˆ†ç»Ÿè®¡
interface ProductReview {
  productId: string;
  productName: string;
  reviews: Array<{
    rating: number;
    comment: string;
  }>;
}

const products: ProductReview[] = [
  {
    productId: 'p1',
    productName: 'Laptop',
    reviews: [
      { rating: 5, comment: 'Excellent!' },
      { rating: 4, comment: 'Good' },
      { rating: 5, comment: 'Amazing' },
    ],
  },
  {
    productId: 'p2',
    productName: 'Mouse',
    reviews: [
      { rating: 4, comment: 'Nice' },
      { rating: 3, comment: 'OK' },
    ],
  },
];

// è®¡ç®—æ¯ä¸ªäº§å“çš„å¹³å‡è¯„åˆ†
const avgRatings = products.map((p) => ({
  name: p.productName,
  avgRating: meanBy(p.reviews, (r) => r.rating),
}));

console.log(avgRatings);
// [
//   { name: 'Laptop', avgRating: 4.67 },
//   { name: 'Mouse', avgRating: 3.5 }
// ]

// ç¤ºä¾‹8: å“åº”æ—¶é—´ç›‘æ§
interface ApiLog {
  endpoint: string;
  responseTime: number;
  timestamp: Date;
  statusCode: number;
}

const apiLogs: ApiLog[] = [
  { endpoint: '/api/users', responseTime: 120, timestamp: new Date(), statusCode: 200 },
  { endpoint: '/api/users', responseTime: 150, timestamp: new Date(), statusCode: 200 },
  { endpoint: '/api/products', responseTime: 200, timestamp: new Date(), statusCode: 200 },
  { endpoint: '/api/users', responseTime: 130, timestamp: new Date(), statusCode: 200 },
];

// è®¡ç®—ç‰¹å®šæ¥å£çš„å¹³å‡å“åº”æ—¶é—´
const usersEndpointLogs = apiLogs.filter((log) => log.endpoint === '/api/users');
const avgResponseTime = meanBy(usersEndpointLogs, (log) => log.responseTime);

console.log(`Average response time for /api/users: ${avgResponseTime.toFixed(2)}ms`);
// Average response time for /api/users: 133.33ms

// ç¤ºä¾‹9: å­¦ç”Ÿæˆç»©åˆ†æ
interface StudentGrade {
  studentId: string;
  name: string;
  grades: {
    assignments: number[];
    midterm: number;
    final: number;
  };
}

const students: StudentGrade[] = [
  {
    studentId: 's1',
    name: 'Alice',
    grades: { assignments: [85, 90, 88], midterm: 87, final: 92 },
  },
  {
    studentId: 's2',
    name: 'Bob',
    grades: { assignments: [78, 82, 80], midterm: 81, final: 85 },
  },
];

// è®¡ç®—ç­çº§å¹³å‡æˆç»© (assignments 40%, midterm 30%, final 30%)
const classAvg = meanBy(students, (student) => {
  const assignmentsAvg = student.grades.assignments.reduce((a, b) => a + b, 0) / student.grades.assignments.length;
  return assignmentsAvg * 0.4 + student.grades.midterm * 0.3 + student.grades.final * 0.3;
});

console.log(`Class average: ${classAvg.toFixed(2)}`); // Class average: 85.37

// ç¤ºä¾‹10: é”€å”®ä¸šç»©åˆ†æ
interface SalesRep {
  id: string;
  name: string;
  monthlySales: number[];
}

const salesTeam: SalesRep[] = [
  { id: 'r1', name: 'Alice', monthlySales: [50000, 55000, 52000, 58000] },
  { id: 'r2', name: 'Bob', monthlySales: [45000, 48000, 47000, 50000] },
  { id: 'r3', name: 'Charlie', monthlySales: [60000, 62000, 58000, 65000] },
];

// è®¡ç®—å›¢é˜Ÿå¹³å‡æœˆé”€å”®é¢
const teamAvgMonthlySales = meanBy(salesTeam, (rep) => {
  return rep.monthlySales.reduce((a, b) => a + b, 0) / rep.monthlySales.length;
});

console.log(`Team average monthly sales: $${teamAvgMonthlySales.toFixed(2)}`);
// Team average monthly sales: $54166.67

// æ‰¾å‡ºé«˜äºå¹³å‡æ°´å¹³çš„é”€å”®ä»£è¡¨
const topPerformers = salesTeam.filter((rep) => {
  const repAvg = rep.monthlySales.reduce((a, b) => a + b, 0) / rep.monthlySales.length;
  return repAvg > teamAvgMonthlySales;
});

console.log(
  'Top performers:',
  topPerformers.map((r) => r.name),
); // ['Alice', 'Charlie']
```

## äº¤äº’å¼ç¤ºä¾‹

```tsx live
function MeanByExample() {
  const [students, setStudents] = React.useState([
    { name: 'Alice', score: 85 },
    { name: 'Bob', score: 92 },
    { name: 'Charlie', score: 78 },
    { name: 'David', score: 88 },
  ]);

  const average = meanBy(students, (s) => s.score);

  const handleScoreChange = (index, newScore) => {
    const newStudents = [...students];
    newStudents[index].score = Math.max(0, Math.min(100, Number(newScore) || 0));
    setStudents(newStudents);
  };

  return (
    <div style={{ padding: '20px', background: '#f5f5f5', borderRadius: '8px' }}>
      <h4>meanBy äº¤äº’å¼ç¤ºä¾‹</h4>
      <div style={{ marginBottom: '15px' }}>
        <strong>å­¦ç”Ÿæˆç»©:</strong>
        <div style={{ marginTop: '10px' }}>
          {students.map((student, index) => (
            <div
              key={index}
              style={{
                padding: '10px',
                margin: '5px 0',
                background: 'white',
                borderRadius: '4px',
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
              }}
            >
              <span style={{ fontWeight: 'bold', minWidth: '100px' }}>{student.name}</span>
              <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
                <input
                  type="number"
                  value={student.score}
                  onChange={(e) => handleScoreChange(index, e.target.value)}
                  min="0"
                  max="100"
                  style={{ width: '60px', padding: '5px' }}
                />
                <span
                  style={{
                    color: student.score >= average ? '#4caf50' : '#ff9800',
                    fontSize: '12px',
                  }}
                >
                  {student.score >= average ? 'é«˜äºå¹³å‡' : 'ä½äºå¹³å‡'}
                </span>
              </div>
            </div>
          ))}
        </div>
      </div>
      <div
        style={{
          background: 'white',
          padding: '15px',
          borderRadius: '4px',
          marginTop: '15px',
        }}
      >
        <strong>ç­çº§å¹³å‡åˆ†:</strong>
        <div style={{ fontSize: '24px', color: '#1976d2', fontWeight: 'bold', marginTop: '10px' }}>
          {average.toFixed(2)}
        </div>
      </div>
    </div>
  );
}
```

## æ³¨æ„äº‹é¡¹

- âš ï¸ **è¾¹ç•Œæƒ…å†µ**: å½“æ•°ç»„ä¸ºç©ºæ—¶ï¼Œå‡½æ•°è¿”å› `0`
- âš ï¸ **è¾¹ç•Œæƒ…å†µ**: å½“å‚æ•°ä¸æ˜¯æ•°ç»„æ—¶ï¼Œå‡½æ•°è¿”å› `0`
- ğŸ’¡ **æ€§èƒ½æç¤º**: å‡½æ•°æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œå…ˆæ±‚å’Œå†é™¤ä»¥æ•°ç»„é•¿åº¦
- ğŸ”’ **ç±»å‹å®‰å…¨**: ä½¿ç”¨æ³›å‹ `<T>` æ”¯æŒä»»æ„ç±»å‹çš„æ•°ç»„
- ğŸ“š **æœ€ä½³å®è·µ**: iteratee å‡½æ•°åº”è¯¥è¿”å›æ•°å­—ç±»å‹ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´ `NaN` ç»“æœ
- ğŸ¯ **è¿”å›å€¼**: è¿”å›çš„æ˜¯æ•°å­—å¹³å‡å€¼ï¼Œä¸æ˜¯æ•°ç»„å…ƒç´ 
- âš¡ **æµ®ç‚¹æ•°**: JavaScript æµ®ç‚¹æ•°å¯èƒ½æœ‰ç²¾åº¦é—®é¢˜ï¼Œå»ºè®®ä½¿ç”¨ `toFixed()` æ ¼å¼åŒ–ç»“æœ
- ğŸ“Š **ç»Ÿè®¡æ„ä¹‰**: å¹³å‡å€¼å¯¹å¼‚å¸¸å€¼æ•æ„Ÿï¼Œè€ƒè™‘æ˜¯å¦éœ€è¦ä½¿ç”¨ä¸­ä½æ•°ç­‰å…¶ä»–ç»Ÿè®¡æŒ‡æ ‡

## ç›¸å…³å‡½æ•°

- [`sumBy`](./sumBy) - æŒ‰æ¡ä»¶è®¡ç®—æ•°ç»„å…ƒç´ çš„æ€»å’Œ
- [`maxBy`](./maxBy) - æŒ‰æ¡ä»¶è·å–æ•°ç»„ä¸­çš„æœ€å¤§é¡¹
- [`minBy`](./minBy) - æŒ‰æ¡ä»¶è·å–æ•°ç»„ä¸­çš„æœ€å°é¡¹
- [`groupBy`](../collection/groupBy) - æŒ‰æ¡ä»¶åˆ†ç»„æ•°æ®

## ç‰ˆæœ¬å†å²

- **v0.0.1** - åˆå§‹ç‰ˆæœ¬
