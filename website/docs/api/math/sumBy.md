---
id: sumBy
title: sumBy
description: 'Calculates the sum of values generated by an iteratee function'
---

# `sumBy`

é€šè¿‡è¿­ä»£å‡½æ•°è®¡ç®—æ•°ç»„å…ƒç´ ç”Ÿæˆçš„å€¼çš„æ€»å’Œã€‚è¿™ä¸ªå‡½æ•°å…è®¸ä½ å¯¹å¯¹è±¡æ•°ç»„è¿›è¡Œæ±‚å’Œæ“ä½œï¼Œè€Œä¸ä»…ä»…æ˜¯ç®€å•çš„æ•°å­—æ•°ç»„ã€‚

## è¯­æ³•

```typescript
function sumBy<T>(array: T[], iteratee: (item: T) => number): number;
```

## å‚æ•°

| å‚æ•°å     | ç±»å‹                  | å¿…å¡« | é»˜è®¤å€¼ | æè¿°                                       |
| ---------- | --------------------- | ---- | ------ | ------------------------------------------ |
| `array`    | `T[]`                 | âœ…   | -      | è¦è¿­ä»£çš„æ•°ç»„                               |
| `iteratee` | `(item: T) => number` | âœ…   | -      | æ¯ä¸ªå…ƒç´ è°ƒç”¨çš„è¿­ä»£å‡½æ•°ï¼Œè¿”å›ç”¨äºæ±‚å’Œçš„æ•°å€¼ |

## è¿”å›å€¼

- **ç±»å‹**: `number`
- **æè¿°**: è¿”å›è®¡ç®—å¾—åˆ°çš„æ€»å’Œã€‚å¦‚æœæ•°ç»„ä¸ºç©ºæˆ–æ— æ•ˆï¼Œè¿”å› `0`

## ç¤ºä¾‹

### åŸºç¡€ç”¨æ³•

```typescript
import { sumBy } from '@rabjs/kit';

// ç¤ºä¾‹1: å¯¹è±¡æ•°ç»„ - æŒ‰å±æ€§æ±‚å’Œ
const products = [
  { name: 'Laptop', price: 1000 },
  { name: 'Mouse', price: 25 },
  { name: 'Keyboard', price: 75 },
];
const totalPrice = sumBy(products, (p) => p.price);
console.log(totalPrice); // 1100

// ç¤ºä¾‹2: è®¡ç®—å±æ€§æ±‚å’Œ
const items = [
  { quantity: 3, unitPrice: 10 },
  { quantity: 2, unitPrice: 15 },
  { quantity: 5, unitPrice: 8 },
];
const totalValue = sumBy(items, (item) => item.quantity * item.unitPrice);
console.log(totalValue); // 100 (3*10 + 2*15 + 5*8)

// ç¤ºä¾‹3: ç©ºæ•°ç»„
console.log(sumBy([], (x) => x.value)); // 0
```

### é«˜çº§ç”¨æ³•

```typescript
// ç¤ºä¾‹4: åµŒå¥—å¯¹è±¡
interface Order {
  id: string;
  items: Array<{
    productId: string;
    quantity: number;
    price: number;
  }>;
}

const orders: Order[] = [
  {
    id: 'order1',
    items: [
      { productId: 'p1', quantity: 2, price: 10 },
      { productId: 'p2', quantity: 1, price: 20 },
    ],
  },
  {
    id: 'order2',
    items: [{ productId: 'p3', quantity: 3, price: 15 }],
  },
];

// è®¡ç®—æ‰€æœ‰è®¢å•çš„æ€»é‡‘é¢
const totalRevenue = sumBy(orders, (order) => order.items.reduce((sum, item) => sum + item.quantity * item.price, 0));
console.log(totalRevenue); // 85 (40 + 45)

// ç¤ºä¾‹5: æ¡ä»¶æ±‚å’Œ
const scores = [
  { student: 'Alice', score: 85, passed: true },
  { student: 'Bob', score: 62, passed: false },
  { student: 'Charlie', score: 90, passed: true },
];

// åªè®¡ç®—é€šè¿‡å­¦ç”Ÿçš„åˆ†æ•°
const passedTotal = sumBy(
  scores.filter((s) => s.passed),
  (s) => s.score,
);
console.log(passedTotal); // 175

// ç¤ºä¾‹6: å­—ç¬¦ä¸²é•¿åº¦æ±‚å’Œ
const messages = [
  { id: 1, text: 'Hello' },
  { id: 2, text: 'World' },
  { id: 3, text: 'Test' },
];
const totalLength = sumBy(messages, (m) => m.text.length);
console.log(totalLength); // 14
```

### å®é™…åº”ç”¨åœºæ™¯

```typescript
// ç¤ºä¾‹7: è´­ç‰©è½¦æ€»ä»·è®¡ç®—
interface CartItem {
  productId: string;
  name: string;
  price: number;
  quantity: number;
  discount: number; // æŠ˜æ‰£ç™¾åˆ†æ¯”
}

const cartItems: CartItem[] = [
  { productId: '1', name: 'Laptop', price: 1000, quantity: 1, discount: 10 },
  { productId: '2', name: 'Mouse', price: 50, quantity: 2, discount: 0 },
  { productId: '3', name: 'Keyboard', price: 80, quantity: 1, discount: 15 },
];

const cartTotal = sumBy(cartItems, (item) => {
  const subtotal = item.price * item.quantity;
  const discountAmount = subtotal * (item.discount / 100);
  return subtotal - discountAmount;
});

console.log(`Cart Total: $${cartTotal.toFixed(2)}`); // Cart Total: $1068.00

// ç¤ºä¾‹8: å‘˜å·¥å·¥èµ„ç»Ÿè®¡
interface Employee {
  id: string;
  name: string;
  baseSalary: number;
  bonus: number;
  deductions: number;
}

const employees: Employee[] = [
  { id: 'e1', name: 'Alice', baseSalary: 5000, bonus: 1000, deductions: 500 },
  { id: 'e2', name: 'Bob', baseSalary: 6000, bonus: 1500, deductions: 600 },
  { id: 'e3', name: 'Charlie', baseSalary: 5500, bonus: 1200, deductions: 550 },
];

const totalPayroll = sumBy(employees, (emp) => emp.baseSalary + emp.bonus - emp.deductions);
console.log(`Total Payroll: $${totalPayroll}`); // Total Payroll: $18050

// ç¤ºä¾‹9: é¡¹ç›®æ—¶é—´ç»Ÿè®¡
interface Task {
  name: string;
  estimatedHours: number;
  actualHours: number;
  completed: boolean;
}

const tasks: Task[] = [
  { name: 'Design', estimatedHours: 20, actualHours: 22, completed: true },
  { name: 'Development', estimatedHours: 40, actualHours: 45, completed: true },
  { name: 'Testing', estimatedHours: 15, actualHours: 12, completed: true },
  { name: 'Deployment', estimatedHours: 5, actualHours: 0, completed: false },
];

const totalEstimated = sumBy(tasks, (t) => t.estimatedHours);
const totalActual = sumBy(
  tasks.filter((t) => t.completed),
  (t) => t.actualHours,
);
const variance = totalActual - totalEstimated + tasks.find((t) => !t.completed)!.estimatedHours;

console.log(`Estimated: ${totalEstimated}h`); // 80h
console.log(`Actual (completed): ${totalActual}h`); // 79h
console.log(`Variance: ${variance}h`); // 4h

// ç¤ºä¾‹10: æ•°æ®ä¼ è¾“ç»Ÿè®¡
interface DataTransfer {
  filename: string;
  sizeInMB: number;
  compressionRatio: number; // å‹ç¼©æ¯”ä¾‹ (0-1)
}

const transfers: DataTransfer[] = [
  { filename: 'data1.zip', sizeInMB: 100, compressionRatio: 0.6 },
  { filename: 'data2.zip', sizeInMB: 200, compressionRatio: 0.7 },
  { filename: 'data3.zip', sizeInMB: 150, compressionRatio: 0.65 },
];

const totalOriginalSize = sumBy(transfers, (t) => t.sizeInMB);
const totalCompressedSize = sumBy(transfers, (t) => t.sizeInMB * t.compressionRatio);
const savedSpace = totalOriginalSize - totalCompressedSize;

console.log(`Original: ${totalOriginalSize}MB`); // 450MB
console.log(`Compressed: ${totalCompressedSize}MB`); // 292.5MB
console.log(`Saved: ${savedSpace}MB`); // 157.5MB
```

## äº¤äº’å¼ç¤ºä¾‹

```tsx live
function SumByExample() {
  const [items, setItems] = React.useState([
    { name: 'å•†å“A', price: 100, quantity: 2 },
    { name: 'å•†å“B', price: 50, quantity: 3 },
    { name: 'å•†å“C', price: 75, quantity: 1 },
  ]);

  const total = sumBy(items, (item) => item.price * item.quantity);

  const handleQuantityChange = (index, delta) => {
    const newItems = [...items];
    newItems[index].quantity = Math.max(0, newItems[index].quantity + delta);
    setItems(newItems);
  };

  return (
    <div style={{ padding: '20px', background: '#f5f5f5', borderRadius: '8px' }}>
      <h4>sumBy äº¤äº’å¼ç¤ºä¾‹</h4>
      <div style={{ marginBottom: '15px' }}>
        <strong>è´­ç‰©æ¸…å•:</strong>
        <div style={{ marginTop: '10px' }}>
          {items.map((item, index) => (
            <div
              key={index}
              style={{
                padding: '10px',
                margin: '5px 0',
                background: 'white',
                borderRadius: '4px',
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
              }}
            >
              <div>
                <div style={{ fontWeight: 'bold' }}>{item.name}</div>
                <div style={{ fontSize: '12px', color: '#666' }}>å•ä»·: Â¥{item.price}</div>
              </div>
              <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
                <button onClick={() => handleQuantityChange(index, -1)} style={{ padding: '5px 10px' }}>
                  -
                </button>
                <span style={{ minWidth: '30px', textAlign: 'center' }}>{item.quantity}</span>
                <button onClick={() => handleQuantityChange(index, 1)} style={{ padding: '5px 10px' }}>
                  +
                </button>
                <span style={{ minWidth: '60px', textAlign: 'right', color: '#1976d2' }}>
                  Â¥{item.price * item.quantity}
                </span>
              </div>
            </div>
          ))}
        </div>
      </div>
      <div
        style={{
          background: 'white',
          padding: '15px',
          borderRadius: '4px',
          marginTop: '15px',
        }}
      >
        <strong>æ€»è®¡:</strong>
        <div style={{ fontSize: '24px', color: '#1976d2', fontWeight: 'bold', marginTop: '10px' }}>Â¥{total}</div>
      </div>
    </div>
  );
}
```

## æ³¨æ„äº‹é¡¹

- âš ï¸ **è¾¹ç•Œæƒ…å†µ**: å½“æ•°ç»„ä¸ºç©ºæ—¶ï¼Œå‡½æ•°è¿”å› `0`
- âš ï¸ **è¾¹ç•Œæƒ…å†µ**: å½“å‚æ•°ä¸æ˜¯æ•°ç»„æ—¶ï¼Œå‡½æ•°è¿”å› `0`
- ğŸ’¡ **æ€§èƒ½æç¤º**: å‡½æ•°æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œä½¿ç”¨ `reduce` å®ç°
- ğŸ”’ **ç±»å‹å®‰å…¨**: ä½¿ç”¨æ³›å‹ `<T>` æ”¯æŒä»»æ„ç±»å‹çš„æ•°ç»„
- ğŸ“š **æœ€ä½³å®è·µ**: iteratee å‡½æ•°åº”è¯¥è¿”å›æ•°å­—ç±»å‹ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´ `NaN` ç»“æœ
- ğŸ¯ **è¿”å›å€¼**: è¿”å›çš„æ˜¯æ•°å­—æ€»å’Œï¼Œä¸æ˜¯æ•°ç»„å…ƒç´ 
- âš¡ **æµ®ç‚¹æ•°**: å¯¹äºæ¶‰åŠé‡‘é¢çš„è®¡ç®—ï¼Œæ³¨æ„ JavaScript æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜ï¼Œå»ºè®®ä½¿ç”¨ä¸“é—¨çš„é‡‘é¢å¤„ç†åº“

## ç›¸å…³å‡½æ•°

- [`meanBy`](./meanBy) - æŒ‰æ¡ä»¶è®¡ç®—æ•°ç»„å…ƒç´ çš„å¹³å‡å€¼
- [`maxBy`](./maxBy) - æŒ‰æ¡ä»¶è·å–æ•°ç»„ä¸­çš„æœ€å¤§é¡¹
- [`minBy`](./minBy) - æŒ‰æ¡ä»¶è·å–æ•°ç»„ä¸­çš„æœ€å°é¡¹
- [`groupBy`](../collection/groupBy) - æŒ‰æ¡ä»¶åˆ†ç»„æ•°æ®

## ç‰ˆæœ¬å†å²

- **v1.0.0** - åˆå§‹ç‰ˆæœ¬
